# サポートページ：ウイルス感染の数理モデルとシミュレーション ―データを定量的に理解する

Google Colabratory [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics)  
Jupyter（Binder） [![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/NU-iBLab/Book-VirusDynamics/main)  
RStudio（Binder） [![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/NU-iBLab/Book-VirusDynamics/main?urlpath=rstudio)

## このリポジトリについて

『ウイルス感染の数理モデルとシミュレーション ―データを定量的に理解する』のサポートページとして、本書に記載のコードを公開するリポジトリです。

目次の後に使い方等の補足を載せています。


## 目次

### 第2章

- コード2-1：関数プロットの実装
  - [Python (notebook)](./code/Python_ipynb/02_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb.02_01.ipynb)
  - [R (notebook)](./code/R_ipynb/02_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/02_01.ipynb)
  - [R](./code/R/02_01.R)
  
- コード2-2：最小二乗法によるパラメータ推定の実装
  - [Python (notebook)](./code/Python_ipynb/02_02.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/02_02.ipynb)
  - [R (notebook)](./code/R_ipynb/02_02.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/02_02.ipynb)
  - [R](./code/R/02_02.R)
  
- コード2-3：線形常微分方程式の数値計算の実装
  - [Python (notebook)](./code/Python_ipynb/02_03.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/02_03.ipynb)
  - [R (notebook)](./code/R_ipynb/02_03.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/02_03.ipynb)
  - [R](./code/R/02_03.R)
  
- コード2-4：非線形常微分方程式の数値計算の実装  
  - [Python (notebook)](./code/Python_ipynb/02_04.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/02_04.ipynb)
  - [R (notebook)](./code/R_ipynb/02_04.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/02_04.ipynb)
  - [R](./code/R/02_04.R)

### 第3章

- コード3-1：ギレスピーアルゴリズムによる確率シミュレーションの実装  
  - [Python (notebook)](./code/Python_ipynb/03_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/03_01.ipynb)
  - [R (notebook)](./code/R_ipynb/03_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/03_01.ipynb)
  - [R](./code/R/03_01.R)
  
- コード3-2：各種回帰モデルの実装  
  - [Python (notebook)](./code/Python_ipynb/03_02.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/03_02.ipynb)
  - [R (notebook)](./code/R_ipynb/03_02.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/03_02.ipynb)
  - [R](./code/R/03_02.R)

### 第4章

- コード4-1：時間遅れをもつ微分方程式の数値計算の実装  
  - [Python (notebook)](./code/Python_ipynb/04_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/04_01.ipynb)
  - [R (notebook)](./code/R_ipynb/04_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/04_01.ipynb)
  - [R](./code/R/04_01.R)

### 第5章

- コード5-1：MCMCを用いたベイズ推定の実装  
  - [Python (notebook)](./code/Python_ipynb/05_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/05_01.ipynb)
  - [R (notebook)](./code/R_ipynb/05_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/05_01.ipynb)
  - [R](./code/R/05_01.R)
  
- コード5-2：拡散方程式の数値計算の実装  
  - [Python (notebook)](./code/Python_ipynb/05_02.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/05_02.ipynb)
  - [R (notebook)](./code/R_ipynb/05_02.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/05_02.ipynb)
  - [R](./code/R/05_02.R)

### 第7章

- コード7-1：偏微分方程式の数値計算の実装  
  - [Python (notebook)](./code/Python_ipynb/07_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/07_01.ipynb)
  - [R (notebook)](./code/R_ipynb/07_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/07_01.ipynb)
  - [R](./code/R/07_01.R)
  
- コード7-2：個体ベースシミュレーションの数値計算の実装  
  - [Python (notebook)](./code/Python_ipynb/07_02.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/07_02.ipynb)
  - [R (notebook)](./code/R_ipynb/07_02.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/07_02.ipynb)
  - [R](./code/R/07_02.R)


### 第8章

- コード8-1：NLMEMを用いたパラメータ推定の実装  
  - [Python (notebook)](./code/Python_ipynb/08_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/08_01.ipynb)
  - [R (notebook)](./code/R_ipynb/08_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/08_01.ipynb)
  - [R](./code/R/08_01.R)


### 第9章

- コード9-1：ランダムフォレストの実装  
  - [Python (notebook)](./code/Python_ipynb/09_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/Python_ipynb/09_01.ipynb)
  - [R (notebook)](./code/R_ipynb/09_01.ipynb) [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/NU-iBLab/Book-VirusDynamics/code/R_ipynb/09_01.ipynb)
  - [R](./code/R/09_01.R)
  

## 補足

### RとPythonについて

Rは統計解析ソフトウェアとして長く利用されてきた歴史があり、著者らが最もよく使用している。  
Pythonは機械学習などによるデータ解析によく使われている。

- R言語（Wikipedia）
  - https://ja.wikipedia.org/wiki/R%E8%A8%80%E8%AA%9E  
- Python（Wikipedia）  
  - https://ja.wikipedia.org/wiki/Python

それぞれのプログラミング言語の利用環境は数多く存在する。

- Project Jupyter（Wikipedia）
  - https://ja.wikipedia.org/wiki/Project_Jupyter
- RStudio
  - https://en.wikipedia.org/wiki/RStudio
  
Google ColaboratoryとBinderで利用できるようにファイル群やボタンを用意しましたが、基本的には自身のPC等で環境を整えて利用する方が良いです。


### このリポジトリの構造

```bash
- data/ ## データファイルの格納場所
- code/ ## コードファイルの格納場所
    + Python_ipynb/ ## Pythonコードファイルの格納場所
    + R_ipynb/ ## R（Jupyter利用）コードファイルの格納場所
    + R/ ## Rコードファイルの格納場所
- assets/ ## コードの中に表示する画像ファイルなど
- README.md ## このファイル
- DockerFile ## Dockerで起動するJupyterLab用のファイル
- docker-compose.yml ## Dockerで起動するJupyterLab用のファイル
- requirements.txt
- install.R
- runtime.txt
```


### コードの利用方法

#### Google Colaboratoryの利用

目次から![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)をクリックするとGoogle Colaboratoryで開き、実行することができますが、ファイルの入出力がある場合にはエラーになります。Google Colaboratoryを利用する場合は、対応するファイル群を自身のGoogleドライブにアップロードして利用すると良いです。
- [Google Colaboratory](https://colab.research.google.com/)

#### Binderの利用

JupyterLabとRStudioを以下のボタンから利用できます。

- JupyterLab

[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/NU-iBLab/Book-VirusDynamics/main)

- RStudio

[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/NU-iBLab/Book-VirusDynamics/main?urlpath=rstudio)


#### ファイルのダウンロード

リリースからダウンロードしてください。  
[Releases](https://github.com/NU-iBLab/Book-VirusDynamics/releases)

または、ダウンロードボタンからダウンロードするかコマンドラインで最新版をクローンできます。

```bash
$ git clone https://github.com/NU-iBLab/Book-VirusDynamics.git
```


#### JupyterLabの利用

`.ipynb`の拡張子を持つファイルはJupyterLabなどを利用して利用することが可能です。  
- [Project Jupyter \| Home](https://jupyter.org/)

Rで書かれた`.ipynb`の拡張子を持つファイル（`./code/R_ipynb`）はIRkernelのインストールが必要です。  
- [Installation · IRkernel](https://irkernel.github.io/installation/#binary-panel)
- [IRkernel/IRkernel: R kernel for Jupyter](https://github.com/IRkernel/IRkernel)


#### DockerからJupyterLabを起動して利用

リポジトリの全てのファイルをダウンロードして好きな場所に保存します。terminal等で保存したディレクトリに移動します。[docker-compose.yml](./docker-compose.yml)を編集します。以下の`password`となっているトークンを任意の文字列に変更します。

```yml:docker-combose.yml
--NotebookApp.token='password'
```

[DockerFile](./DockerFile)と[docker-compose.yml](./docker-compose.yml)を利用してイメージを作成しコンテナを起動します。

```bash
# ダウンロードした後のdocker-composeとDockerFileと同じディレクトリで実行
$ cd <path-to-these-files>
$ docker-compose build #少し時間がかかります。 #ネットワーク環境が必要です。
$ docker-compose up
```

[http://localhost:8888](http://localhost:8888) にアクセスすることでJupyterLabが利用できます。上記で変更したトークンの入力を求められます。


※JupyterLab動作検証環境一覧
- OS: Ubuntu 20.04 / CPU: Ryzen Threadripper PRO 5975WX 32-Cores @3.6GHz / Memory: 512GB / JupyterLab: Version 3.5.0, RStudio Server: 2023.06.1 Build 524
- MacBook Pro Apple M1 Max (macOS Ventura 13.1)
- iMac Pro Intel Xeon W (macOS Ventura 13.2.1)
- AMD Ryzen 7 3800X (Windows 11 22H2)


### 利用しているPackages、Libraries


#### Python

NumPy, Pnadas, PyStan, 

#### R

deSolve, ggplot2

#### Others

FreeFEM

---

## 本の情報

岩見真吾，中岡慎治，岩波翔也『ウイルス感染の数理モデルとシミュレーション ―データを定量的に理解する』（2024，共立出版）

## 免責事項

このリポジトリのリソースを用いた場合のいかなる損害等について責任は保証しません。

## Contact

岩波翔也  
iwanami.iblab[at]bio.nagoya-u.ac.jp  
[@iwanaminami](https://github.com/iwanaminami)